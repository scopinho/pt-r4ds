<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt" xml:lang="pt"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Hadley Wickham, Mine Çetinkaya-Rundel, e Garrett Grolemund">
<title>R para Ciência de Dados (2ª edição) - 2&nbsp; Visualização de dados</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./whole-game.html" rel="prev">
<link href="./cover.jpg" rel="icon" type="image/jpeg">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Nenhum resultado",
    "search-matching-documents-text": "documentos correspondentes",
    "search-copy-link-title": "Copiar link para a busca",
    "search-hide-matches-text": "Esconder correspondências adicionais",
    "search-more-match-text": "mais correspondência neste documento",
    "search-more-matches-text": "mais correspondências neste documento",
    "search-clear-button-title": "Limpar",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Procurar"
  }
}</script><script defer="" data-domain="r4ds.hadley.nz" src="https://plausible.io/js/plausible.js"></script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./whole-game.html">Whole game</a></li><li class="breadcrumb-item"><a href="./data-visualize.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Visualização de dados</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">R para Ciência de Dados (2ª edição)</a> 
        <div class="sidebar-tools-main">
    <a href="https://cienciadedatos.github.io/pt-r4ds" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-git"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Alternar modo de leitor">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Procurar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Boas-vindas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface-2e.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefácio da segunda edição</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./whole-game.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Whole game</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-visualize.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Visualização de dados</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Índice</h2>
   
  <ul>
<li>
<a href="#introdu%C3%A7%C3%A3o" id="toc-introdução" class="nav-link active" data-scroll-target="#introdu%C3%A7%C3%A3o"><span class="header-section-number">2.1</span> Introdução</a>
  <ul class="collapse">
<li><a href="#pr%C3%A9-requisitos" id="toc-pré-requisitos" class="nav-link" data-scroll-target="#pr%C3%A9-requisitos"><span class="header-section-number">2.1.1</span> Pré-requisitos</a></li>
  </ul>
</li>
  <li>
<a href="#primeiros-passos" id="toc-primeiros-passos" class="nav-link" data-scroll-target="#primeiros-passos"><span class="header-section-number">2.2</span> Primeiros passos</a>
  <ul class="collapse">
<li><a href="#o-data-frame-pinguins" id="toc-o-data-frame-pinguins" class="nav-link" data-scroll-target="#o-data-frame-pinguins"><span class="header-section-number">2.2.1</span> O data frame <code>pinguins</code></a></li>
  <li><a href="#sec-ultimate-goal" id="toc-sec-ultimate-goal" class="nav-link" data-scroll-target="#sec-ultimate-goal"><span class="header-section-number">2.2.2</span> Objetivo final</a></li>
  <li><a href="#criando-um-gr%C3%A1fico-ggplot" id="toc-criando-um-gráfico-ggplot" class="nav-link" data-scroll-target="#criando-um-gr%C3%A1fico-ggplot"><span class="header-section-number">2.2.3</span> Criando um gráfico ggplot</a></li>
  <li><a href="#sec-adding-aesthetics-layers" id="toc-sec-adding-aesthetics-layers" class="nav-link" data-scroll-target="#sec-adding-aesthetics-layers"><span class="header-section-number">2.2.4</span> Adicionando atributos estéticos e camadas</a></li>
  <li><a href="#exerc%C3%ADcios" id="toc-exercícios" class="nav-link" data-scroll-target="#exerc%C3%ADcios"><span class="header-section-number">2.2.5</span> Exercícios</a></li>
  </ul>
</li>
  <li><a href="#sec-ggplot2-calls" id="toc-sec-ggplot2-calls" class="nav-link" data-scroll-target="#sec-ggplot2-calls"><span class="header-section-number">2.3</span> Chamadas ggplot2</a></li>
  <li>
<a href="#visualizando-distribui%C3%A7%C3%B5es" id="toc-visualizando-distribuições" class="nav-link" data-scroll-target="#visualizando-distribui%C3%A7%C3%B5es"><span class="header-section-number">2.4</span> Visualizando distribuições</a>
  <ul class="collapse">
<li><a href="#uma-vari%C3%A1vel-categ%C3%B3rica" id="toc-uma-variável-categórica" class="nav-link" data-scroll-target="#uma-vari%C3%A1vel-categ%C3%B3rica"><span class="header-section-number">2.4.1</span> Uma variável categórica</a></li>
  <li><a href="#uma-vari%C3%A1vel-num%C3%A9rica" id="toc-uma-variável-numérica" class="nav-link" data-scroll-target="#uma-vari%C3%A1vel-num%C3%A9rica"><span class="header-section-number">2.4.2</span> Uma variável numérica</a></li>
  <li><a href="#exerc%C3%ADcios-1" id="toc-exercícios-1" class="nav-link" data-scroll-target="#exerc%C3%ADcios-1"><span class="header-section-number">2.4.3</span> Exercícios</a></li>
  </ul>
</li>
  <li>
<a href="#visualizando-rela%C3%A7%C3%B5es" id="toc-visualizando-relações" class="nav-link" data-scroll-target="#visualizando-rela%C3%A7%C3%B5es"><span class="header-section-number">2.5</span> Visualizando relações</a>
  <ul class="collapse">
<li><a href="#uma-vari%C3%A1vel-num%C3%A9rica-e-uma-vari%C3%A1vel-categ%C3%B3rica" id="toc-uma-variável-numérica-e-uma-variável-categórica" class="nav-link" data-scroll-target="#uma-vari%C3%A1vel-num%C3%A9rica-e-uma-vari%C3%A1vel-categ%C3%B3rica"><span class="header-section-number">2.5.1</span> Uma variável numérica e uma variável categórica</a></li>
  <li><a href="#duas-vari%C3%A1veis-categ%C3%B3ricas" id="toc-duas-variáveis-categóricas" class="nav-link" data-scroll-target="#duas-vari%C3%A1veis-categ%C3%B3ricas"><span class="header-section-number">2.5.2</span> Duas variáveis categóricas</a></li>
  <li><a href="#duas-vari%C3%A1veis-num%C3%A9ricas" id="toc-duas-variáveis-numéricas" class="nav-link" data-scroll-target="#duas-vari%C3%A1veis-num%C3%A9ricas"><span class="header-section-number">2.5.3</span> Duas variáveis numéricas</a></li>
  <li><a href="#tr%C3%AAs-ou-mais-vari%C3%A1veis" id="toc-três-ou-mais-variáveis" class="nav-link" data-scroll-target="#tr%C3%AAs-ou-mais-vari%C3%A1veis"><span class="header-section-number">2.5.4</span> Três ou mais variáveis</a></li>
  <li><a href="#exerc%C3%ADcios-2" id="toc-exercícios-2" class="nav-link" data-scroll-target="#exerc%C3%ADcios-2"><span class="header-section-number">2.5.5</span> Exercícios</a></li>
  </ul>
</li>
  <li>
<a href="#sec-ggsave" id="toc-sec-ggsave" class="nav-link" data-scroll-target="#sec-ggsave"><span class="header-section-number">2.6</span> Salvando seus gráficos</a>
  <ul class="collapse">
<li><a href="#exerc%C3%ADcios-3" id="toc-exercícios-3" class="nav-link" data-scroll-target="#exerc%C3%ADcios-3"><span class="header-section-number">2.6.1</span> Exercícios</a></li>
  </ul>
</li>
  <li><a href="#problemas-comuns" id="toc-problemas-comuns" class="nav-link" data-scroll-target="#problemas-comuns"><span class="header-section-number">2.7</span> Problemas comuns</a></li>
  <li><a href="#resumo" id="toc-resumo" class="nav-link" data-scroll-target="#resumo"><span class="header-section-number">2.8</span> Resumo</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-git"></i></div><div class="action-links"><p><a href="https://cienciadedatos.github.io/pt-r4ds/edit/main/data-visualize.qmd" class="toc-action">Editar essa página</a></p><p><a href="https://cienciadedatos.github.io/pt-r4ds/issues/new" class="toc-action">Criar uma issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-data-visualization" class="quarto-section-identifier"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Visualização de dados</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><section id="introdução" class="level2" data-number="2.1"><h2 data-number="2.1" class="anchored" data-anchor-id="introdução">
<span class="header-section-number">2.1</span> Introdução</h2>
<blockquote class="blockquote">
<p>“O gráfico simples trouxe mais informações à mente dos analistas de dados do que qualquer outro dispositivo.” — John Tukey</p>
</blockquote>
<p>O R possui diversos sistemas para construir gráficos, mas o ggplot2 é um dos mais elegantes e versáteis. O ggplot2 implementa a <strong>gramática dos gráficos</strong>, um sistema coerente para descrever e construir gráficos. Com o ggplot2 você pode fazer mais, e mais rápido, ao aprender um sistema e aplicá-lo em muitos lugares.</p>
<p>Este capítulo irá te ensinar como visualizar seus dados usando o <strong>ggplot2</strong>. Nós vamos começar criando um gráfico de dispersão simples e usá-lo para introduzir o mapeamento de atributos estéticos (<em>aesthetic</em>) e geometrias – os blocos fundamentais na construção do ggplot2. Nós vamos então te orientar na visualização de distribuições de variáveis individuais, bem como na visualização de relações entre duas ou mais variáveis. Terminaremos salvando seus gráficos e com dicas de resolução de problemas.</p>
<section id="pré-requisitos" class="level3" data-number="2.1.1"><h3 data-number="2.1.1" class="anchored" data-anchor-id="pré-requisitos">
<span class="header-section-number">2.1.1</span> Pré-requisitos</h3>
<p>Este capítulo tem foco no ggplot2, um dos principais pacotes do tidyverse. Para acessar os bancos de dados, páginas de ajuda e funções utilizadas neste capítulo, você deve carregar o tidyverse executando o comando:</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; ── Attaching core tidyverse packages ───────────────────── tidyverse 2.0.0 ──</span></span>
<span><span class="co">#&gt; ✔ dplyr     1.1.3     ✔ readr     2.1.4</span></span>
<span><span class="co">#&gt; ✔ forcats   1.0.0     ✔ stringr   1.5.0</span></span>
<span><span class="co">#&gt; ✔ ggplot2   3.4.3     ✔ tibble    3.2.1</span></span>
<span><span class="co">#&gt; ✔ lubridate 1.9.3     ✔ tidyr     1.3.0</span></span>
<span><span class="co">#&gt; ✔ purrr     1.0.2     </span></span>
<span><span class="co">#&gt; ── Conflicts ─────────────────────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">#&gt; ✖ dplyr::filter() masks stats::filter()</span></span>
<span><span class="co">#&gt; ✖ dplyr::lag()    masks stats::lag()</span></span>
<span><span class="co">#&gt; ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Essa única linha de código carrega os pacotes essenciais do tidyverse, que você irá utilizar em quase toda análise de dados. Ela também te diz quais funções do tidyverse possuem conflitos com as função do R base (ou de outro pacote que você tenha carregado)<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<p>Se você rodar este código e receber a mensagem de erro <code>there is no package called 'tidyverse'</code>, você precisará instalar o pacote antes usando a função <code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages()</a></code> ou a interface de instalação do RStudio, e então rodar <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> novamente.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"tidyverse"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Você só precisa instalar um pacote uma vez, mas precisa carregá-lo sempre que iniciar uma nova sessão.</p>
<p>Além do tidyverse, nós também usaremos o pacote <strong>dados</strong>, que inclui várias bases de dados, incluindo um com medidas corporais de pinguins de três ilhas do Arquipélago Palmer, junto do pacote ggthemes, que fornece uma paleta de cores segura para pessoas com daltonismo.</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/cienciadedatos/dados">dados</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jrnold/ggthemes">ggthemes</a></span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="primeiros-passos" class="level2" data-number="2.2"><h2 data-number="2.2" class="anchored" data-anchor-id="primeiros-passos">
<span class="header-section-number">2.2</span> Primeiros passos</h2>
<p>Os pinguins com nadadeiras mais compridas pesam mais ou menos que pinguins com nadadeiras curtas? Você provavelmente já tem uma resposta, mas tente torná-la mais precisa. Como é a relação entre o comprimento da nadadeira e massa corporal? Ela é positiva? Negativa? Linear? Não linear? A relação varia com a espécie do pinguim? E quanto à ilha onde o pinguim vive? Vamos criar visualizações que podemos usar para responder essas perguntas.</p>
<section id="o-data-frame-pinguins" class="level3" data-number="2.2.1"><h3 data-number="2.2.1" class="anchored" data-anchor-id="o-data-frame-pinguins">
<span class="header-section-number">2.2.1</span> O data frame <code>pinguins</code>
</h3>
<p>Você pode testar suas respostas à essas questões usando o <strong>data frame</strong> <code>pinguins</code> encontrado no pacote <code>dados</code> (usando <code><a href="https://rdrr.io/pkg/dados/man/pinguins.html">dados::pinguins</a></code>). Um <em>data frame</em> é uma coleção tabular (formato de tabela) de variáveis (nas colunas) e observações (nas linhas). <code>pinguins</code> contém 344 observações coletadas e disponibilizadas pela Dra. Kristen Gorman e pelo PELD Estação Palmer, Antártica<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>.</p>
<p>Para facilitar a discussão, vamos definir alguns termos:</p>
<ul>
<li><p>Uma <strong>variável</strong> é uma quantidade, qualidade ou propriedade que você pode medir.</p></li>
<li><p>Um <strong>valor</strong> é o estado de uma variável quando você a mede. O valor de uma variável pode mudar de medição para medição.</p></li>
<li><p>Uma <strong>observação</strong> é um conjunto de medições feitas em condições semelhantes (geralmente todas as medições em uma observação são feitas ao mesmo tempo e no mesmo objeto). Uma <strong>observação</strong> conterá vários valores, cada um associado a uma variável diferente. Às vezes, vamos nos referir a uma observação como um ponto de dados.</p></li>
<li><p><strong>Dados tabulares</strong> são um conjunto de valores, cada um associado a uma variável e uma observação. Os dados tabulares estarão no formato <em>tidy</em> (arrumado) se cada valor estiver em sua própria “célula”, cada variável em sua própria coluna e cada observação em sua própria linha.</p></li>
</ul>
<p>Neste contexto, uma variável refere-se a um atributo de todos os pinguins, e uma observação refere-se a todos os atributos de um único pinguim.</p>
<p>Digite o nome do <em>data frame</em> no console e o R mostrará uma visualização de seu conteúdo. Observe que aparece escrito <code>tibble</code> no topo desta visualização. No tidyverse, usamos <em>data frames</em> especiais chamados <strong>tibbles</strong>, dos quais você aprenderá mais em breve.</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pinguins</span></span>
<span><span class="co">#&gt; # A tibble: 344 × 8</span></span>
<span><span class="co">#&gt;   especie           ilha      comprimento_bico profundidade_bico</span></span>
<span><span class="co">#&gt;   &lt;fct&gt;             &lt;fct&gt;                &lt;dbl&gt;             &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 Pinguim-de-adélia Torgersen             39.1              18.7</span></span>
<span><span class="co">#&gt; 2 Pinguim-de-adélia Torgersen             39.5              17.4</span></span>
<span><span class="co">#&gt; 3 Pinguim-de-adélia Torgersen             40.3              18  </span></span>
<span><span class="co">#&gt; 4 Pinguim-de-adélia Torgersen             NA                NA  </span></span>
<span><span class="co">#&gt; 5 Pinguim-de-adélia Torgersen             36.7              19.3</span></span>
<span><span class="co">#&gt; 6 Pinguim-de-adélia Torgersen             39.3              20.6</span></span>
<span><span class="co">#&gt; # ℹ 338 more rows</span></span>
<span><span class="co">#&gt; # ℹ 4 more variables: comprimento_nadadeira &lt;int&gt;, massa_corporal &lt;int&gt;, …</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Este <em>data frame</em> contém 8 colunas. Para uma visualização alternativa, onde você pode ver todas as variáveis e as primeiras observações de cada variável, use <code><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse()</a></code>. Ou, se você estiver no RStudio, execute <code>View(pinguins)</code> para abrir um visualizador de dados interativo.</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">pinguins</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 344</span></span>
<span><span class="co">#&gt; Columns: 8</span></span>
<span><span class="co">#&gt; $ especie               &lt;fct&gt; Pinguim-de-adélia, Pinguim-de-adélia, Pinguim…</span></span>
<span><span class="co">#&gt; $ ilha                  &lt;fct&gt; Torgersen, Torgersen, Torgersen, Torgersen, T…</span></span>
<span><span class="co">#&gt; $ comprimento_bico      &lt;dbl&gt; 39.1, 39.5, 40.3, NA, 36.7, 39.3, 38.9, 39.2,…</span></span>
<span><span class="co">#&gt; $ profundidade_bico     &lt;dbl&gt; 18.7, 17.4, 18.0, NA, 19.3, 20.6, 17.8, 19.6,…</span></span>
<span><span class="co">#&gt; $ comprimento_nadadeira &lt;int&gt; 181, 186, 195, NA, 193, 190, 181, 195, 193, 1…</span></span>
<span><span class="co">#&gt; $ massa_corporal        &lt;int&gt; 3750, 3800, 3250, NA, 3450, 3650, 3625, 4675,…</span></span>
<span><span class="co">#&gt; $ sexo                  &lt;fct&gt; macho, fêmea, fêmea, NA, fêmea, macho, fêmea,…</span></span>
<span><span class="co">#&gt; $ ano                   &lt;int&gt; 2007, 2007, 2007, 2007, 2007, 2007, 2007, 200…</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Entre as variáveis em pinguins estão:</p>
<ol type="1">
<li><p><code>especie</code>: a espécie de um pinguim (Pinguim-de-adélia, Pinguim-de-barbicha e Pinguim-gentoo).</p></li>
<li><p><code>comprimento_nadadeira</code>: comprimento da nadadeira de um pinguim, em milímetros.</p></li>
<li><p><code>massa_corporal</code>: massa corporal de um pinguim, em gramas.</p></li>
</ol>
<p>Para saber mais sobre <code>pinguins</code>, abra sua página de ajuda executando <code><a href="https://rdrr.io/pkg/dados/man/pinguins.html">?pinguins</a></code>.</p>
</section><section id="sec-ultimate-goal" class="level3" data-number="2.2.2"><h3 data-number="2.2.2" class="anchored" data-anchor-id="sec-ultimate-goal">
<span class="header-section-number">2.2.2</span> Objetivo final</h3>
<p>Nosso objetivo final neste capítulo é recriar a seguinte visualização que exibe a relação entre o comprimento da nadadeira e a massa corporal desses pinguins, levando em consideração a espécie do pinguim.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="data-visualize_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" alt="Um gráfico de dispersão da massa corporal vs. comprimento da nadadeira dos pinguins, com uma linha de melhor ajuste da relação entre essas duas variáveis sobreposta. O gráfico mostra uma relação positiva, razoavelmente linear e relativamente forte entre essas duas variáveis. As espécies (Pinguim-de-adélia, Pinguim-de-barbicha e Pinguim-gentoo) são representadas com cores e formas diferentes. A relação entre a massa corporal e o comprimento da nadadeira é aproximadamente a mesma para essas três espécies, e os pinguins Gentoo são maiores do que os pinguins das outras duas espécies." width="576"></p>
</div>
</div>
</section><section id="criando-um-gráfico-ggplot" class="level3" data-number="2.2.3"><h3 data-number="2.2.3" class="anchored" data-anchor-id="criando-um-gráfico-ggplot">
<span class="header-section-number">2.2.3</span> Criando um gráfico ggplot</h3>
<p>Vamos recriar esse gráfico passo a passo.</p>
<p>No ggplot2, você inicia um gráfico com a função <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>, definindo um objeto de gráfico ao qual você adiciona <strong>camadas</strong>. O primeiro argumento da função <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> é o conjunto de dados a ser usado no gráfico e, portanto, <code>ggplot(data = pinguins)</code> cria um gráfico vazio que está preparado para exibir os dados dos <code>pinguins</code>, mas, como ainda não dissemos como fazer a visualização, por enquanto ele está vazio. Esse não é um gráfico muito interessante, mas você pode pensar nele como uma tela vazia na qual você pintará as camadas restantes do seu gráfico.</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pinguins</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data-visualize_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" alt="Uma área de plotagem vazia em cinza" width="576"></p>
</div>
</div>
<p>Em seguida, precisamos informar ao <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> como as informações dos nossos dados serão representadas visualmente. O argumento <code>mapping</code> (mapeamento) da função <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> define como as variáveis em seu conjunto de dados são mapeadas para as propriedades visuais (<strong>estética</strong>) do gráfico. O argumento <code>mapping</code> é sempre definido na função <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>, e os argumentos <code>x</code> e <code>y</code> de <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> especificam quais variáveis devem ser mapeadas nos eixos x e y. Por enquanto, mapearemos apenas o comprimento da nadadeira para o atributo estético <code>x</code> e a massa corporal para o atributo <code>y</code>. O ggplot2 procura as variáveis mapeadas no argumento <code>data</code>, nesse caso, <code>pinguins</code>.</p>
<p>O gráfico a seguir mostra o resultado da adição desses mapeamentos.</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">pinguins</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">comprimento_nadadeira</span>, y <span class="op">=</span> <span class="va">massa_corporal</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data-visualize_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" alt="O gráfico mostra o comprimento da nadadeira no eixo x, com valores que variam de 170 a 230, e a massa corporal no eixo y, com valores que variam de 3000 a 6000." width="576"></p>
</div>
</div>
<p>Nossa tela vazia agora está mais estruturada: está claro onde os comprimentos das nadadeiras serão exibidos (no eixo x) e onde as massas corporais serão exibidas (no eixo y). Mas os pinguins em si ainda não estão no gráfico. Isso ocorre porque ainda não definimos, em nosso código, como representar as observações de nosso <em>data frame</em> em nosso gráfico.</p>
<p>Para isso, precisamos definir um <strong>geom</strong>: A geometria que um gráfico usa para representar os dados. Essas geometrias são disponibilizados no ggplot2 com funções que começam com <code>geom_</code>. As pessoas geralmente descrevem os gráficos pelo tipo de geom que o gráfico usa. Por exemplo, os gráficos de barras usam geometrias de barras (<code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code>), os gráficos de linhas usam geometrias de linhas (<code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line()</a></code>), os boxplots usam geometrias de boxplot (<code><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot()</a></code>), os gráficos de dispersão usam geometrias de pontos (<code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>) e assim por diante.</p>
<p>A função <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> adiciona uma camada de pontos ao seu gráfico, o que cria um gráfico de dispersão. O ggplot2 vem com muitas funções de geometria, cada uma adicionando um tipo diferente de camada a um gráfico. Você aprenderá várias geometrias ao longo do livro, principalmente em <span class="quarto-unresolved-ref">?sec-layers</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">pinguins</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">comprimento_nadadeira</span>, y <span class="op">=</span> <span class="va">massa_corporal</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 2 rows containing missing values (`geom_point()`).</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data-visualize_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" alt="Um gráfico de dispersão da massa corporal em função do comprimento da nadadeira dos pinguins. O gráfico mostra uma relação positiva, linear e relativamente forte entre essas duas variáveis." width="576"></p>
</div>
</div>
<p>Agora temos algo que se parece com o que poderíamos chamar de “gráfico de dispersão”. Ele ainda não corresponde ao nosso gráfico mostrado no início da seção “objetivo final”, mas, usando esse gráfico, podemos começar a responder à pergunta que motivou nossa exploração: “Como é a relação entre o comprimento da nadadeira e a massa corporal?” A relação parece ser positiva (à medida que o comprimento da nadadeira aumenta, a massa corporal também aumenta), razoavelmente linear (os pontos estão agrupados em torno de uma linha em vez de uma curva) e moderadamente forte (não há muita dispersão em torno dessa linha). Os pinguins com nadadeiras mais longas geralmente são maiores em termos de massa corporal.</p>
<p>Antes de adicionarmos mais camadas a esse gráfico, vamos parar por um momento e revisar a mensagem de aviso que recebemos:</p>
<blockquote class="blockquote">
<p>Removed 2 rows containing missing values (<code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>).</p>
</blockquote>
<p>Estamos vendo essa mensagem porque há dois pinguins em nosso conjunto de dados com valores faltantes (<em>missing values -</em> NA*) de massa corporal e/ou comprimento da nadadeira e o ggplot2 não tem como representá-los no gráfico sem esses dois valores. Assim como o R, o ggplot2 adota a filosofia de que os valores faltantes nunca devem desaparecer silenciosamente. Esse tipo de aviso é provavelmente um dos tipos mais comuns de avisos que você verá ao trabalhar com dados reais - os valores faltantes são um problema muito comum e você aprenderá mais sobre eles ao longo do livro, especialmente em <span class="quarto-unresolved-ref">?sec-missing-values</span>. Nos demais gráficos deste capítulo, vamos suprimir esse aviso para que ele não seja mostrado em cada gráfico que fizermos.</p>
</section><section id="sec-adding-aesthetics-layers" class="level3" data-number="2.2.4"><h3 data-number="2.2.4" class="anchored" data-anchor-id="sec-adding-aesthetics-layers">
<span class="header-section-number">2.2.4</span> Adicionando atributos estéticos e camadas</h3>
<p>Gráficos de dispersão são úteis para exibir a relação entre duas variáveis numéricas, mas é sempre uma boa ideia ter uma postura cética em relação a qualquer relação aparente entre duas variáveis e perguntar se pode haver outras variáveis que expliquem ou mudem a natureza dessa relação aparente. Por exemplo, a relação entre o comprimento das nadadeira e a massa corporal difere de acordo com a espécie? Vamos incluir as espécies em nosso gráfico e ver se isso revela alguma ideia adicional sobre a relação aparente entre essas variáveis. Faremos isso representando as espécies com pontos de cores diferentes.</p>
<p>Para conseguir isso, precisaremos modificar o atributo estético ou a geometria? Se você pensou “no mapeamento estético, dentro de <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>”, você já está pegando o jeito de criar visualizações de dados com o ggplot2! Caso contrário, não se preocupe. Ao longo do livro, você criará muito mais visualizações com ggplot e terá muito mais oportunidades de verificar sua intuição.</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">pinguins</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">comprimento_nadadeira</span>, y <span class="op">=</span> <span class="va">massa_corporal</span>, color <span class="op">=</span> <span class="va">especie</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data-visualize_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" alt="Um gráfico de dispersão da massa corporal em função do comprimento da nadadeira dos pinguins. O gráfico mostra uma relação positiva, razoavelmente linear e relativamente forte entre essas duas variáveis. As espécies (Pinguim-de-adélia, Pinguim-de-barbicha e Pinguim-gentoo) são representadas com cores diferentes." width="576"></p>
</div>
</div>
<p>Quando uma variável categórica é mapeada a um atributo estético, o ggplot2 atribui automaticamente um valor único da estética (aqui uma cor única) a cada nível único da variável (cada uma das três espécies), um processo conhecido como <strong>dimensionamento</strong>. O ggplot2 também adicionará uma legenda que explica quais valores correspondem a quais níveis.</p>
<p>Agora vamos adicionar mais uma camada: uma curva suave que exibe a relação entre a massa corporal e o comprimento das nadadeiras. Antes de prosseguir, consulte o código acima e pense em como podemos adicionar isso ao nosso gráfico existente.</p>
<p>Como essa é uma nova geometria que representa nossos dados, adicionaremos uma nova geometria como uma camada sobre o nossa geometria de pontos: <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth()</a></code>. E especificaremos que queremos desenhar a linha de melhor ajuste com base em um modelo linear (<code>l</code>inear <code>m</code>odel em inglês) com <code>method = "lm"</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">pinguins</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">comprimento_nadadeira</span>, y <span class="op">=</span> <span class="va">massa_corporal</span>, color <span class="op">=</span> <span class="va">especie</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data-visualize_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" alt="Um gráfico de dispersão da massa corporal em função do comprimento da nadadeira dos pinguins. Sobrepostas ao gráfico de dispersão estão três curvas suavizadas que mostram a relação entre essas variáveis para cada espécie (Pinguim-de-adélia, Pinguim-de-barbicha e Pinguim-gentoo). As diferentes espécies de pinguins são plotadas em cores diferentes para os pontos e as curvas suavizadas." width="576"></p>
</div>
</div>
<p>Adicionamos linhas com sucesso, mas esse gráfico não se parece com o gráfico do <a href="#sec-ultimate-goal"><span>Seção&nbsp;2.2.2</span></a>, que tem apenas uma linha para todo o conjunto de dados, em vez de linhas separadas para cada espécie de pinguim.</p>
<p>Quando os mapeamentos estéticos são definidos em <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>, no nível <strong>global</strong>, eles são passados para cada uma das camadas de geometria (geom) subsequentes do gráfico. Entretanto, cada função geom no ggplot2 também pode receber um argumento <code>mapping</code>, que permite mapeamentos estéticos em nível <strong>local</strong> que são adicionados àqueles herdados do nível global. Como queremos que os pontos sejam coloridos com base na espécie, mas não queremos que as linhas sejam separadas para eles, devemos especificar <code>color = especie</code> somente para <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">pinguins</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">comprimento_nadadeira</span>, y <span class="op">=</span> <span class="va">massa_corporal</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">especie</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data-visualize_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" alt="Um gráfico de dispersão da massa corporal em função do comprimento da nadadeira dos pinguins. Sobreposta ao gráfico de dispersão está uma única linha de melhor ajuste que mostra a relação entre essas variáveis para cada espécie (Pinguim-de-adélia, Pinguim-de-barbicha e Pinguim-gentoo). As diferentes espécies de pinguins são plotadas em cores diferentes somente para os pontos." width="576"></p>
</div>
</div>
<p>Pronto! Temos algo que se parece muito com nosso objetivo final, embora ainda não esteja perfeito. Ainda precisamos usar formas diferentes para cada espécie de pinguim e melhorar os rótulos.</p>
<p>Geralmente, não é uma boa ideia representar informações usando apenas cores em um gráfico, pois as pessoas percebem as cores de forma diferente devido ao daltonismo ou a outras diferenças de visão de cores. Portanto, além da cor, também podemos mapear <code>especie</code> para a estética <code>shape</code> (forma).</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">pinguins</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">comprimento_nadadeira</span>, y <span class="op">=</span> <span class="va">massa_corporal</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">especie</span>, shape <span class="op">=</span> <span class="va">especie</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data-visualize_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" alt="Um gráfico de dispersão da massa corporal em função do comprimento da nadadeira dos pinguins. Sobreposta ao gráfico de dispersão está uma única linha de melhor ajuste que mostra a relação entre essas variáveis para cada espécie (Pinguim-de-adélia, Pinguim-de-barbicha e Pinguim-gentoo). As diferentes espécies de pinguins são plotadas em cores e formas diferentes somente para os pontos." width="576"></p>
</div>
</div>
<p>Observe que a legenda também é atualizada automaticamente para refletir as diferentes formas dos pontos.</p>
<p>E, finalmente, podemos melhorar os rótulos do nosso gráfico usando a função <code><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs()</a></code> em uma nova camada. Alguns dos argumentos de <code><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs()</a></code> podem ser autoexplicativos: <code>title</code> adiciona um título e <code>subtitle</code> adiciona um subtítulo ao gráfico. Outros argumentos correspondem aos mapeamentos estéticos, <code>x</code> é o rótulo do eixo x, <code>y</code> é o rótulo do eixo y e <code>color</code> e <code>shape</code> definem o rótulo da legenda. Além disso, podemos aprimorar a paleta de cores para que seja segura para pessoas com daltonismo com a função <code><a href="https://rdrr.io/pkg/ggthemes/man/colorblind.html">scale_color_colorblind()</a></code> do pacote ggthemes.</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">pinguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">comprimento_nadadeira</span>, y <span class="op">=</span> <span class="va">massa_corporal</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">especie</span>, shape <span class="op">=</span> <span class="va">especie</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Massa corporal e comprimento da nadadeira"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Medidas para Pinguim-de-adélia, Pinguim-de-barbicha e Pinguim-gentoo"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Comprimento da nadadeira (mm)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Massa corporal (g)"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Espécie"</span>,</span>
<span>    shape <span class="op">=</span> <span class="st">"Espécie"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/colorblind.html">scale_color_colorblind</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data-visualize_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" alt="Um gráfico de dispersão da massa corporal em função do comprimento da nadadeira dos pinguins, junto de uma linha de melhor ajuste sobreposta que mostra a relação entre essas duas variáveis. O gráfico mostra uma relação positiva, razoavelmente linear e relativamente forte entre essas duas variáveis. As espécies (Pinguim-de-adélia,  Pinguim-de-barbicha e Pinguim-gentoo) são representadas com cores e  formas diferentes. A relação entre a massa corporal e o comprimento  das nadadeiras é praticamente a mesma para essas três espécies, e os pinguins-gentoo são maiores do que os pinguins das outras duas  espécies." width="576"></p>
</div>
</div>
<p>Finalmente temos um gráfico que corresponde perfeitamente ao nosso “objetivo final”!</p>
</section><section id="exercícios" class="level3" data-number="2.2.5"><h3 data-number="2.2.5" class="anchored" data-anchor-id="exercícios">
<span class="header-section-number">2.2.5</span> Exercícios</h3>
<ol type="1">
<li><p>Quantas linhas existem em <code>pinguins</code>? E quantas colunas?</p></li>
<li><p>O que a variável <code>profundidade_bico</code> no <em>data frame</em> <code>pinguins</code> descreve? Leia a documentação da base pinguins para descobrir, utilizando o comando <code><a href="https://rdrr.io/pkg/dados/man/pinguins.html">?pinguins</a></code> .</p></li>
<li><p>Faça um gráfico de dispersão de <code>profundidade_bico</code> em função de <code>comprimento_bico</code>. Ou seja, faça um gráfico de dispersão com <code>profundidade_bico</code> no eixo y e <code>comprimento_bico</code> no eixo x. Descreva a relação entre essas duas variáveis.</p></li>
<li><p>O que acontece se você fizer um gráfico de dispersão de <code>especie</code> em função de <code>profundidade_bico</code>? Qual seria uma melhor escolha de geometria (<em>geom</em>)?</p></li>
<li><p>Por que o seguinte erro ocorre e como você poderia corrigi-lo?</p></li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pinguins</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="6" type="1">
<li><p>O que o argumento <code>na.rm</code> faz em <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>? Qual é o valor padrão do argumento? Crie um gráfico de dispersão em que você use esse argumento definido como <code>TRUE</code> (verdadeiro).</p></li>
<li><p>Adicione a seguinte legenda ao gráfico que você criou no exercício anterior: “Os dados são provenientes do pacote dados”. Dica: dê uma olhada na documentação da função <code><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs()</a></code>.</p></li>
<li><p>Recrie a visualização a seguir. Para qual atributo estético <code>profundidade_bico</code> deve ser mapeada? E ela deve ser mapeada no nível global ou no nível da geometria?</p></li>
</ol>
<div class="cell">
<div class="cell-output-display">
<p><img src="data-visualize_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" alt="Um gráfico de dispersão da massa corporal em função do comprimento da  nadadeira dos pinguins, colorido pela profundidade do bico. Uma curva suave da relação entre a massa corporal e o comprimento da nadadeira está sobreposta. A relação é positiva, razoavelmente linear e moderadamente forte." width="576"></p>
</div>
</div>
<ol start="9" type="1">
<li>Execute esse código em sua mente e preveja como será o resultado. Em seguida, execute o código no R e verifique suas previsões.</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">pinguins</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">comprimento_nadadeira</span>, y <span class="op">=</span> <span class="va">massa_corporal</span>, color <span class="op">=</span> <span class="va">ilha</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="10" type="1">
<li>Esses dois gráficos serão diferentes? Por que sim ou por que não?</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">pinguins</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">comprimento_nadadeira</span>, y <span class="op">=</span> <span class="va">massa_corporal</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">pinguins</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">comprimento_nadadeira</span>, y <span class="op">=</span> <span class="va">massa_corporal</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">pinguins</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">comprimento_nadadeira</span>, y <span class="op">=</span> <span class="va">massa_corporal</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="sec-ggplot2-calls" class="level2" data-number="2.3"><h2 data-number="2.3" class="anchored" data-anchor-id="sec-ggplot2-calls">
<span class="header-section-number">2.3</span> Chamadas ggplot2</h2>
<p>À medida que passarmos dessas seções introdutórias, faremos a transição para uma expressão mais concisa do código do ggplot2. Até agora, temos sido muito explícitos, o que é útil quando se está aprendendo:</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">pinguins</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">comprimento_nadadeira</span>, y <span class="op">=</span> <span class="va">massa_corporal</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Normalmente, o primeiro ou os dois primeiros argumentos de uma função são tão importantes que você logo saberá usar eles de cor. Os dois primeiros argumentos de <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> são <code>data</code> e <code>mapping</code>; no restante do livro, não escreveremos esses nomes. Isso economiza digitação e, ao reduzir a quantidade de texto extra, facilita a visualização das diferenças entre os gráficos. Essa é uma preocupação de programação realmente importante, à qual voltaremos em <span class="quarto-unresolved-ref">?sec-functions</span>.</p>
<p>Reescrevendo o gráfico anterior de forma mais concisa, temos:</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">pinguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">comprimento_nadadeira</span>, y <span class="op">=</span> <span class="va">massa_corporal</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>No futuro, você também aprenderá sobre o <em>pipe</em> (encadeamento), <code>|&gt;</code>, que permitirá que você crie esse gráfico com a seguinte sintaxe:</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pinguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">comprimento_nadadeira</span>, y <span class="op">=</span> <span class="va">massa_corporal</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="visualizando-distribuições" class="level2" data-number="2.4"><h2 data-number="2.4" class="anchored" data-anchor-id="visualizando-distribuições">
<span class="header-section-number">2.4</span> Visualizando distribuições</h2>
<p>A forma como você visualiza a distribuição de uma variável depende do tipo de variável: categórica ou numérica.</p>
<section id="uma-variável-categórica" class="level3" data-number="2.4.1"><h3 data-number="2.4.1" class="anchored" data-anchor-id="uma-variável-categórica">
<span class="header-section-number">2.4.1</span> Uma variável categórica</h3>
<p>Uma variável é <strong>categórica</strong> se puder assumir apenas um valor de um pequeno conjunto de valores. Para examinar a distribuição de uma variável categórica, você pode usar um gráfico de barras. A altura das barras exibe quantas observações ocorreram com cada valor <code>x</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">pinguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">especie</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data-visualize_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" alt="Um gráfico de barras das frequências das espécies de pinguins: Pinguim-de-Adélia (aproximadamente 150), Pinguim-de-barbicha (aproximadamente 90), Pinguim-Gentoo (aproximadamente 125)." width="576"></p>
</div>
</div>
<p>Em gráficos de barras de variáveis categóricas com níveis não ordenados, como a <code>especie</code> de pinguim acima, geralmente é preferível reordenar as barras com base em suas frequências. Para isso, é necessário transformar a variável em um fator (como o R lida com dados categóricos) e, em seguida, reordenar os níveis desse fator.</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">pinguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_inorder.html">fct_infreq</a></span><span class="op">(</span><span class="va">especie</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data-visualize_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" alt="Um gráfico de barras das frequências das espécies de pinguins, onde as barras estão ordenadas em ordem decrescente das alturas (frequências): Pinguim-de-Adélia (aproximadamente 150), Pinguim-Gentoo (aproximadamente 125), Pinguim-de-barbicha (aproximadamente 90)." width="576"></p>
</div>
</div>
<p>Você aprenderá mais sobre fatores e funções para lidar com fatores (como <code><a href="https://forcats.tidyverse.org/reference/fct_inorder.html">fct_infreq()</a></code> mostrado acima) em <span class="quarto-unresolved-ref">?sec-factors</span>.</p>
</section><section id="uma-variável-numérica" class="level3" data-number="2.4.2"><h3 data-number="2.4.2" class="anchored" data-anchor-id="uma-variável-numérica">
<span class="header-section-number">2.4.2</span> Uma variável numérica</h3>
<p>Uma variável é <strong>numérica</strong> (ou quantitativa) se puder assumir uma ampla gama de valores numéricos e se for possível adicionar, subtrair ou calcular médias com esses valores. As variáveis numéricas podem ser contínuas ou discretas.</p>
<p>Uma visualização comumente usada para distribuições de variáveis contínuas é um histograma.</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">pinguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">massa_corporal</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data-visualize_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" alt="Um histograma da massa corporal dos pinguins. A distribuição é unimodal e inclinada para a direita, variando entre aproximadamente 2500 e 6500 gramas." width="576"></p>
</div>
</div>
<p>Um histograma divide o eixo x em intervalos igualmente espaçados e, em seguida, usa a altura de uma barra para exibir o número de observações que se enquadram em cada intervalo. No gráfico acima, a barra mais alta mostra que 39 observações têm um valor <code>massa_corporal</code> entre 3500 e 3700 gramas, que são as bordas esquerda e direita da barra.</p>
<p>Você pode definir a largura dos intervalos em um histograma com o argumento <em>binwidth</em> (largura do intervalo), que é medido nas unidades da variável <code>x</code>. Você deve sempre explorar uma variedade de larguras de intervalos ao trabalhar com histogramas, pois diferentes larguras de intervalos podem revelar padrões diferentes. Nos gráficos abaixo, uma largura de intervalo de 20 é muito estreita, resultando em muitas barras, o que dificulta a determinação da forma da distribuição. Da mesma forma, uma largura de intervalo de 2000 é muito alta, resultando em todos os dados sendo agrupados em apenas três barras, o que também dificulta a determinação da forma da distribuição. Uma largura de intervalo de 200 proporciona um balanço mais adequado.</p>
<div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">pinguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">massa_corporal</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">pinguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">massa_corporal</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="data-visualize_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" alt="Dois histogramas da massa corporal de pinguins, um com largura de intervalo de 20 (esquerda) e outro com largura de intervalo de 2000 (direita). O histograma com largura de intervalo de 20 mostra muitos altos e baixos nas alturas das barras, criando um contorno irregular. O histograma com largura de intervalo de 2000 mostra apenas três compartimentos." width="288"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="data-visualize_files/figure-html/unnamed-chunk-26-2.png" class="img-fluid" alt="Dois histogramas da massa corporal de pinguins, um com largura de intervalo de 20 (esquerda) e outro com largura de intervalo de 2000 (direita). O histograma com largura de intervalo de 20 mostra muitos altos e baixos nas alturas das barras, criando um contorno irregular. O histograma com largura de intervalo de 2000 mostra apenas três compartimentos." width="288"></p>
</div>
</div>
</div>
</div>
<p>Uma visualização alternativa para distribuições de variáveis numéricas é um gráfico de densidade. Um gráfico de densidade é uma versão suavizada de um histograma e uma alternativa prática, especialmente para dados contínuos provenientes de uma distribuição suavizada subjacente. Não entraremos em detalhes sobre como <code><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density()</a></code> estima a densidade (você pode ler mais sobre isso na documentação da função), mas vamos explicar como a curva de densidade é desenhada com uma analogia. Imagine um histograma feito de blocos de madeira. Em seguida, imagine que você jogue um fio de espaguete cozido sobre ele. A forma que o espaguete assumirá sobre os blocos pode ser considerada como a forma da curva de densidade. Ela mostra menos detalhes do que um histograma, mas pode facilitar a obtenção rápida da forma da distribuição, principalmente com relação à moda (valor que ocorre com maior frequência) e à assimetria.</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">pinguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">massa_corporal</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 2 rows containing non-finite values (`stat_density()`).</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data-visualize_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" alt="Um gráfico de densidade da massa corporal dos pinguins. A distribuição é unimodal e inclinada para a direita, variando entre aproximadamente 2500 e 6500 gramas." width="576"></p>
</div>
</div>
</section><section id="exercícios-1" class="level3" data-number="2.4.3"><h3 data-number="2.4.3" class="anchored" data-anchor-id="exercícios-1">
<span class="header-section-number">2.4.3</span> Exercícios</h3>
<ol type="1">
<li><p>Faça um gráfico de barras de <code>especie</code> de <code>pinguins</code>, no qual você atribui <code>especie</code> ao atributo estético <code>y</code>. Como esse gráfico é diferente?</p></li>
<li><p>Como os dois gráficos a seguir são diferentes? Qual atributo estético, <code>color</code> ou <code>fill</code>, é mais útil para alterar a cor das barras?</p></li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">pinguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">especie</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">pinguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">especie</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li><p>O que o argumento <code>bins</code> em <code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram()</a></code> faz?</p></li>
<li><p>Faça um histograma da variável <code>quilate</code> no conjunto de dados <code>diamante</code> que está disponível quando você carrega o pacote dados. Faça experiências com diferentes larguras de intervalo (<em>binwidth</em>). Qual largura de intervalo revela os padrões mais interessantes?</p></li>
</ol></section></section><section id="visualizando-relações" class="level2" data-number="2.5"><h2 data-number="2.5" class="anchored" data-anchor-id="visualizando-relações">
<span class="header-section-number">2.5</span> Visualizando relações</h2>
<p>Para visualizar uma relação, precisamos ter pelo menos duas variáveis mapeadas para os atributos estéticos de um gráfico. Nas seções a seguir, você aprenderá sobre os gráficos comumente usados para visualizar relações entre duas ou mais variáveis e as geometrias usados para criá-los.</p>
<section id="uma-variável-numérica-e-uma-variável-categórica" class="level3" data-number="2.5.1"><h3 data-number="2.5.1" class="anchored" data-anchor-id="uma-variável-numérica-e-uma-variável-categórica">
<span class="header-section-number">2.5.1</span> Uma variável numérica e uma variável categórica</h3>
<p>Para visualizar a relação entre uma variável numérica e uma variável categórica, podemos usar diagramas de caixa (chamados <strong><em>boxplots</em></strong>) lado a lado. Um <strong>boxplot</strong> é um tipo de abreviação visual para medidas de posição (percentis) que descrevem uma distribuição. Também é útil para identificar possíveis <em>outliers</em>. Conforme mostrado em <a href="#fig-eda-boxplot">Figura&nbsp;<span>2.1</span></a>, cada boxplot consiste em:</p>
<ul>
<li><p>Uma caixa que indica o intervalo da metade intermediária dos dados, uma distância conhecida como intervalo interquartil (IIQ), que se estende do 25º percentil da distribuição até o 75º percentil. No meio da caixa há uma linha que exibe a mediana, ou seja, o 50º percentil, da distribuição. Essas três linhas lhe dão uma noção da dispersão da distribuição e se a distribuição é ou não simétrica em relação à mediana ou inclinada para um lado.</p></li>
<li><p>Pontos que apresentam observações com valores maiores que 1,5 vezes o IIQ de qualquer borda da caixa. Esses pontos discrepantes são incomuns e, por isso, são plotados individualmente.</p></li>
<li><p>Uma linha que se estende de cada extremidade da caixa e vai até o ponto mais distante (sem considerar os valores discrepantes - <em>outliers</em>) na distribuição.</p></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div id="fig-eda-boxplot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/EDA-boxplot.png" class="img-fluid figure-img" alt="Um diagrama exibindo como um boxplot é criado seguindo os passos acima." width="1066"></p>
<figcaption class="figure-caption">Figura&nbsp;2.1: Diagrama mostrando como um boxplot é criado.</figcaption></figure>
</div>
</div>
</div>
<p>Vamos dar uma olhada na distribuição da massa corporal por espécie usando <code><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot()</a></code>:</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">pinguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">especie</span>, y <span class="op">=</span> <span class="va">massa_corporal</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data-visualize_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" alt="Boxplots lado a lado da distribuição da massa corporal de Pinguim-de-adélia, Pinguim-de-barbicha e Pinguim-gentoo. A distribuição das massas corporais dos pinguins-de-Adélia e Pinguim-de-barbicha parece ser simétrica, com medianas em torno de 3.750 gramas. A massa corporal mediana dos Pinguim-gentoo é muito mais alta, em torno de 5.000 gramas, e a distribuição das massas corporais desses pinguins parece ser um pouco inclinada para a direita." width="576"></p>
</div>
</div>
<p>Como alternativa, podemos criar gráficos de densidade com <code><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">pinguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">massa_corporal</span>, color <span class="op">=</span> <span class="va">especie</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data-visualize_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" alt="Um gráfico de densidade da massa corporal de pinguins separado por espécie. Cada espécie (Pinguim-de-adélia, Pinguim-de-barbicha e Pinguim-gentoo) é representada por um contorno colorido diferente em cada curva de densidade." width="576"></p>
</div>
</div>
<p>Também personalizamos a espessura das linhas usando o argumento <code>linewidth</code> para que elas se destaquem um pouco mais contra o plano de fundo.</p>
<p>Além disso, podemos mapear <code>especie</code> para os atributos estéticos <code>color</code> e <code>fill</code> e usar o atributo <code>alpha</code> para adicionar transparência às curvas de densidade preenchidas. Esse atributo assume valores entre 0 (completamente transparente) e 1 (completamente opaco). No gráfico a seguir, ela está <em>definida</em> como 0.5.</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">pinguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">massa_corporal</span>, color <span class="op">=</span> <span class="va">especie</span>, fill <span class="op">=</span> <span class="va">especie</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data-visualize_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" alt="Um gráfico de densidade da massa corporal de pinguins separado por espécie. Cada espécie (Pinguim-de-adélia, Pinguim-de-barbicha e Pinguim-gentoo) é representada por um contorno colorido diferente em cada curva de densidade. As curvas de densidade também são preenchidas com as mesmas cores, com alguma transparência adicionada." width="576"></p>
</div>
</div>
<p>Observe a terminologia que usamos aqui:</p>
<ul>
<li>Nós <strong>mapeamos</strong> variáveis para atributos estéticos se quisermos que o atributo visual representado por esse atributo varie de acordo com os valores dessa variável.</li>
<li>Caso contrário, nós <strong>definimos</strong> o valor de um atributo estético.</li>
</ul></section><section id="duas-variáveis-categóricas" class="level3" data-number="2.5.2"><h3 data-number="2.5.2" class="anchored" data-anchor-id="duas-variáveis-categóricas">
<span class="header-section-number">2.5.2</span> Duas variáveis categóricas</h3>
<p>Podemos usar gráficos de barras empilhadas para visualizar a relação entre duas variáveis categóricas. Por exemplo, os dois gráficos de barras empilhadas a seguir exibem a relação entre <code>ilha</code> e <code>espécie</code> ou, especificamente, a visualização da distribuição de <code>espécie</code> em cada ilha.</p>
<p>O primeiro gráfico mostra as frequências de cada espécie de pinguim em cada ilha. O gráfico de frequências mostra que há um número igual de Pinguim-de-adélia em cada ilha. Mas não temos uma boa noção do equilíbrio percentual em cada ilha.</p>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">pinguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ilha</span>, fill <span class="op">=</span> <span class="va">especie</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data-visualize_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" alt="Gráfico de barras das espécies de pinguins por ilha (Biscoe, Dream, e Torgersen)" width="576"></p>
</div>
</div>
<p>O segundo gráfico é um gráfico de frequência relativa, criado pela definição de <code>position = "fill"</code> na geometria, que é mais útil para comparar as distribuições de espécies entre as ilhas, pois não é afetado pelo número desigual de pinguins entre as ilhas. Usando esse gráfico, podemos ver que todos os Pinguim-gentoo vivem na ilha Biscoe e constituem aproximadamente 75% dos pinguins dessa ilha, todos os Pinguim-de-barbicha vivem na ilha Dream e constituem aproximadamente 50% dos pinguins dessa ilha, e os Pinguim-de-adélia vivem nas três ilhas e constituem todos os pinguins da ilha Torgersen.</p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">pinguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ilha</span>, fill <span class="op">=</span> <span class="va">especie</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data-visualize_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" alt="Gráfico de barras das espécies de pinguins por ilha (Biscoe, Dream, e Torgersen). As barras estão redimensionadas para terem a mesma altura, tornando este um gráfico de frequência relativa." width="576"></p>
</div>
</div>
<p>Ao criar esses gráficos de barras, mapeamos a variável que será separada em barras para o atributo estético <code>x</code> e a variável que mudará as cores dentro das barras para a estética <code>fill</code>.</p>
</section><section id="duas-variáveis-numéricas" class="level3" data-number="2.5.3"><h3 data-number="2.5.3" class="anchored" data-anchor-id="duas-variáveis-numéricas">
<span class="header-section-number">2.5.3</span> Duas variáveis numéricas</h3>
<p>Até agora, você aprendeu sobre gráficos de dispersão (criados com <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>) e curvas suaves (criadas com <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth()</a></code>) para visualizar a relação entre duas variáveis numéricas. Um gráfico de dispersão é provavelmente o gráfico mais usado para visualizar a relação entre duas variáveis numéricas.</p>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">pinguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">comprimento_nadadeira</span>, y <span class="op">=</span> <span class="va">massa_corporal</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data-visualize_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" alt="Um gráfico de dispersão da massa corporal em função do comprimento da nadadeira dos pinguins. O gráfico mostra uma relação positiva, linear e relativamente forte entre essas duas variáveis." width="576"></p>
</div>
</div>
</section><section id="três-ou-mais-variáveis" class="level3" data-number="2.5.4"><h3 data-number="2.5.4" class="anchored" data-anchor-id="três-ou-mais-variáveis">
<span class="header-section-number">2.5.4</span> Três ou mais variáveis</h3>
<p>Como vimos em <a href="#sec-adding-aesthetics-layers"><span>Seção&nbsp;2.2.4</span></a>, podemos incorporar mais variáveis em um gráfico mapeando-as para atributos estéticos adicionais. Por exemplo, no gráfico de dispersão a seguir, as cores dos pontos (<em>color</em>) representam espécies e as formas dos pontos (<em>shape</em>) representam ilhas.</p>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">pinguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">comprimento_nadadeira</span>, y <span class="op">=</span> <span class="va">massa_corporal</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">especie</span>, shape <span class="op">=</span> <span class="va">ilha</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data-visualize_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" alt="Um gráfico de dispersão da massa corporal em função do comprimento da nadadeira dos pinguins. O gráfico mostra uma relação positiva, linear e relativamente forte entre essas duas variáveis. Os pontos são coloridos com base na espécie dos pinguins e as formas dos pontos representam ilhas (os pontos redondos são a ilha Biscoe, os triângulos são a ilha Dream e os quadrados são a ilha Torgersen). O gráfico é muito carregado e é difícil distinguir as formas dos pontos." width="576"></p>
</div>
</div>
<p>No entanto, mapear muitos atributos estéticos a um gráfico faz com que ele fique desordenado e difícil de entender. Outra maneira, que é particularmente útil para variáveis categóricas, é dividir seu gráfico em <strong>facetas</strong> (<em>facets</em>), subdivisões ou janelas que exibem um subconjunto dos dados cada uma.</p>
<p>Para separar seu gráfico em facetas por uma única variável, use <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code>. O primeiro argumento de <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code> é uma fórmula<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>, que você cria com <code>~</code> seguido do nome de uma variável. A variável que você passa para <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code> deve ser categórica.</p>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">pinguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">comprimento_nadadeira</span>, y <span class="op">=</span> <span class="va">massa_corporal</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">especie</span>, shape <span class="op">=</span> <span class="va">especie</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">ilha</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data-visualize_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" alt="Um gráfico de dispersão da massa corporal em função do comprimento da nadadeira dos pinguins. As formas e cores dos pontos representam as espécies. Os pinguins de cada ilha estão em uma faceta separada. Em cada faceta, a relação entre a massa corporal e o comprimento da nadadeira é positiva, linear e relativamente forte." width="768"></p>
</div>
</div>
<p>Você vai aprender sobre muitas outras geometrias para visualizar distribuições de variáveis e relações entre elas em <span class="quarto-unresolved-ref">?sec-layers</span>.</p>
</section><section id="exercícios-2" class="level3" data-number="2.5.5"><h3 data-number="2.5.5" class="anchored" data-anchor-id="exercícios-2">
<span class="header-section-number">2.5.5</span> Exercícios</h3>
<ol type="1">
<li><p>O <em>data frame</em> <code>milhas</code> que acompanha o pacote dados contém observações 234 coletadas pela Agência de Proteção Ambiental dos EUA em modelos de 38 carros. Quais variáveis em <code>milhas</code> são categóricas? Quais variáveis são numéricas? (Dica: digite <code><a href="https://rdrr.io/pkg/dados/man/milhas.html">?milhas</a></code> para ler a documentação do conjunto de dados.) Como você pode ver essas informações ao executar <code>milhas</code>?</p></li>
<li><p>Faça um gráfico de dispersão de <code>rodovia</code> (Milhas rodoviárias por galão) em função de <code>cilindrada</code> usando o <em>data frame</em> <code>milhas</code>. Em seguida, mapeie uma terceira variável numérica para <code>color</code> (cor), depois <code>size</code> (tamanho), depois igualmente para <code>color</code> e <code>size</code> e, por fim, <code>shape</code> (forma). Como esses atributos estéticos se comportam de forma diferente para variáveis categóricas e numéricas?</p></li>
<li><p>No gráfico de dispersão de <code>rodovia</code> vs.&nbsp;<code>cilindrada</code>, o que acontece se você mapear uma terceira variável para <code>linewidth</code> (espessura da linha)?</p></li>
<li><p>O que acontece se você mapear a mesma variável para várias atributos estéticos?</p></li>
<li><p>Faça um gráfico de dispersão de <code>profundidade_bico</code> vs.&nbsp;<code>comprimento_bico</code> e pinte os pontos por <code>especie</code>. O que a adição da coloração por especie revela sobre a relação entre essas duas variáveis? E quanto à separação em facetas por <code>especie</code>?</p></li>
<li><p>Por que o seguinte código produz duas legendas separadas? Como você corrigiria isso para combinar as duas legendas?</p></li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">pinguins</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">comprimento_bico</span>, y <span class="op">=</span> <span class="va">profundidade_bico</span>, </span>
<span>    color <span class="op">=</span> <span class="va">especie</span>, shape <span class="op">=</span> <span class="va">especie</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"especie"</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="7" type="1">
<li>Crie os dois gráficos de barras empilhadas a seguir. Que pergunta você pode responder com o primeiro? Que pergunta você pode responder com o segundo?</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">pinguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ilha</span>, fill <span class="op">=</span> <span class="va">especie</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">pinguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">especie</span>, fill <span class="op">=</span> <span class="va">ilha</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="sec-ggsave" class="level2" data-number="2.6"><h2 data-number="2.6" class="anchored" data-anchor-id="sec-ggsave">
<span class="header-section-number">2.6</span> Salvando seus gráficos</h2>
<p>Depois de criar um gráfico, talvez você queira tirá-lo do R salvando-o como uma imagem que possa ser usada em outro lugar. Esse é o objetivo da função <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code>, que salvará no computador o gráfico criado mais recentemente:</p>
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">pinguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">comprimento_nadadeira</span>, y <span class="op">=</span> <span class="va">massa_corporal</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="st">"penguin-plot.png"</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Isso salvará o gráfico no seu diretório de trabalho, um conceito sobre o qual você aprenderá mais em <span class="quarto-unresolved-ref">?sec-workflow-scripts-projects</span>.</p>
<p>Se você não especificar a largura <code>width</code> e a altura <code>height</code>, elas serão tiradas das dimensões do dispositivo de plotagem atual. Para obter um código reprodutível, você deverá especificá-los. Você pode obter mais informações sobre a função <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code> na documentação.</p>
<p>De modo geral, entretanto, recomendamos que você monte seus relatórios finais usando o Quarto, um sistema de escrita reprodutível que permite intercalar seu código e sua escrita e incluir automaticamente seus gráficos em seus relatórios. Você aprenderá mais sobre o Quarto em <span class="quarto-unresolved-ref">?sec-quarto</span>.</p>
<section id="exercícios-3" class="level3" data-number="2.6.1"><h3 data-number="2.6.1" class="anchored" data-anchor-id="exercícios-3">
<span class="header-section-number">2.6.1</span> Exercícios</h3>
<ol type="1">
<li>Execute as seguintes linhas de código. Qual dos dois gráficos é salvo como <code>grafico-milhas.png</code>? Por quê?</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">classe</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">milhas</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cidade</span>, y <span class="op">=</span> <span class="va">rodovia</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span><span class="st">"grafico-milhas.png"</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li>O que você precisa alterar no código acima para salvar o gráfico como PDF em vez de PNG? Como você poderia descobrir quais tipos de arquivos de imagem funcionariam em <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code>?</li>
</ol></section></section><section id="problemas-comuns" class="level2" data-number="2.7"><h2 data-number="2.7" class="anchored" data-anchor-id="problemas-comuns">
<span class="header-section-number">2.7</span> Problemas comuns</h2>
<p>Ao começar a executar o código em R, é provável que você encontre problemas. Não se preocupe, isso acontece com todo mundo. Todos nós estamos escrevendo código em R há anos, mas todos os dias ainda escrevemos códigos que não funciona na primeira tentativa!</p>
<p>Comece comparando cuidadosamente o código que está executando com o código do livro. O R é extremamente exigente, e um caractere mal colocado pode fazer toda a diferença. Certifique-se de que cada <code>(</code> seja combinado com um <code>)</code> e que cada <code>"</code> seja combinado com outra <code>"</code>. Às vezes, você executará o código e nada acontecerá. Verifique o lado esquerdo do console: se houver um <code>+</code>, isso significa que o R acha que você não digitou uma expressão completa e está esperando que você a termine. Nesse caso, geralmente é fácil começar do zero novamente pressionando <em>Esc</em> para interromper o processamento do comando atual.</p>
<p>Um problema comum ao criar gráficos ggplot2 é colocar o <code>+</code> no lugar errado: ele deve vir no final da linha, não no início. Em outras palavras, certifique-se de não ter escrito acidentalmente um código como este:</p>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">milhas</span><span class="op">)</span> </span>
<span><span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cilindrada</span>, y <span class="op">=</span> <span class="va">rodovia</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Se você ainda estiver com dificuldades, tente a ajuda (painel <em>Help</em>). Você pode obter ajuda sobre qualquer função do R executando <code>?nome_da_função</code> no console ou selecionando o nome da função e pressionando F1 no RStudio. Não se preocupe se a ajuda não parecer muito útil - em vez disso, pule para os exemplos e procure um código que corresponda ao que você está tentando fazer.</p>
<p>Se isso não ajudar, leia atentamente a mensagem de erro. Às vezes, a resposta estará escondida lá! Mas quando você é iniciante no R, mesmo que a resposta esteja na mensagem de erro, talvez você ainda não saiba como entendê-la. Outra ferramenta excelente é o Google: tente pesquisar a mensagem de erro no Google, pois é provável que outra pessoa tenha tido o mesmo problema e tenha obtido ajuda on-line.</p>
</section><section id="resumo" class="level2" data-number="2.8"><h2 data-number="2.8" class="anchored" data-anchor-id="resumo">
<span class="header-section-number">2.8</span> Resumo</h2>
<p>Neste capítulo, você aprendeu os fundamentos da visualização de dados com o ggplot2. Começamos com a ideia básica que sustenta o ggplot2: uma visualização é um mapeamento de variáveis em seus dados para atributos estéticos como posição (<em>position</em>), cor (<em>color</em>), tamanho (<em>size</em>) e forma (<em>shape</em>). Em seguida, você aprendeu a aumentar a complexidade e melhorar a apresentação de seus gráficos camada por camada. Você também aprendeu sobre gráficos comumente usados para visualizar a distribuição de uma única variável, bem como para visualizar relações entre duas ou mais variáveis ao utilizar mapeamentos de atributos estéticos adicionais e/ou dividindo seu gráfico em pequenos gráficos usando facetas.</p>
<p>Usaremos as visualizações repetidamente ao longo deste livro, introduzindo novas técnicas à medida que precisarmos delas, além de nos aprofundarmos na criação de visualizações com o ggplot2 em <span class="quarto-unresolved-ref">?sec-layers</span> por meio da <span class="quarto-unresolved-ref">?sec-communication</span>.</p>
<p>Com as noções básicas de visualização em seu currículo, no próximo capítulo mudaremos um pouco a direção e daremos algumas orientações práticas sobre o fluxo de trabalho. Intercalamos conselhos sobre fluxo de trabalho com ferramentas de ciência de dados ao longo desta parte do livro, pois isso te ajudará a manter a organização à medida que você escreve quantidades cada vez maiores de código em R.</p>


</section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>Você pode eliminar essa mensagem e forçar com que a resolução de conflitos aconteça sob demanda utilizando o pacote conflicted, que se torna mais importante à medida que carrega mais pacotes. Você pode ler mais sobre o pacote conflicted no endereço <a href="https://conflicted.r-lib.org" class="uri">https://conflicted.r-lib.org</a>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Horst AM, Hill AP, Gorman KB (2020). palmerpinguins: Palmer Archipelago (Antarctica) penguin data. R package version 0.1.0. <a href="https://allisonhorst.github.io/palmerpinguins/" class="uri">https://allisonhorst.github.io/palmerpinguins/</a>. doi: 10.5281/zenodo.3960218.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Aqui “fórmula” é o nome da coisa criada por <code>~</code>, não um sinônimo de “equação”.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiada");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiada");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./whole-game.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Whole game</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">R para Ciência de Dados (2ª edição) foi escrito por Hadley Wickham, Mine Çetinkaya-Rundel, e Garrett Grolemund.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">Este livro foi contruído com <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>


</body></html>